
<!DOCTYPE html>
<html>
<head>
<title>新竹市產業發展潛力分析地圖</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" rel="stylesheet">

 <style>
#map {
 height: 100%;
 width: 100%;
 padding:0px;
 margin:auto 0;
}

html,body{
  height:100%;
}
.btn{
  margin-top:5px;
cursor:pointer;
font-family:Microsoft JhengHei;
}
.head-banner{
  background-color:#282c37;
color:white;
}
	  
.attr_bar{
 width:80%;
 background-color:RGB(0,78,102);
}

.attr_value{
 width:0.1px;
 background-color:RGB(111,203,218);
}

.attr_str{
 text-align:right;
 color:white;
 background-color:RGB(111,203,218);
}

.right_panel{
color:white;
position:fixed;
height:100%;
width:30%;
top:0;
right:0;
z-index:101;
padding-left: 15px;
padding-top: 30px;
}

.right_panel_background{
position:fixed;
height:100%;
width:30%;
top:0;
right:0;
background-color: RGB(51,51,51);
opacity:0.8;
z-index:100;
}
 </style> 
 
</head>
 
 
 
<body>

<div class="container-fluid" style="height:100%">
  <div class="row" style="height:100%">
    <!--
	<div class="col-md-12 head-banner" style="height:10%">
       <label style="text-align:center">新竹市產業發展潛力分析地圖</label>
    </div>
	-->
	
	<div class="col-md-12 col-xs-12" id="map">
    </div>
    
	<div class="col-xs-12 right_panel">
	  <div>
	    <button class="btn btn-primary" onclick="initMap()">區域發展潛力分析地圖</button>
	    <div class="btn btn-primary" onclick="pop_heat_map()">全區人口熱區圖</div>
	  </div>
	  <div id = "test">
	      
	  </div>
	  
	</div>
	<div class="right_panel_background">
	</div>
  </div>
</div> 
 
<script>


//////////////////google maps////////////////////////////
var rectangle;
var map;
var population_list;
var households_list;
//var infoWindow;
var rank;
var pr;
var jdata;
var rec_object_list = [];
var bounds=[];
var ingradient_colors = [
    "RGB(212,89,65)",
	"RGB(227,143,114)",
	"RGB(242,196,163)",
	"RGB(252,240,203)",
	"RGB(198,199,191)",
	"RGB(127,146,174)",
	"RGB(68,100,160)"
	];

$.ajax({
     url:"https://togetherhoo.github.io/JS/hsinchucity_fishnet.json",
	 //url:"https://togetherhoo.github.io/JS/taiwan_fishnet_Export2.json",
	 //改圖資的話記得要改createRecs()裡面產生的物件數量
	 async: false,
     type:"GET",
     dataType: "json",
     success: function(Adata){
         jdata = Adata;
	 },
	 error:function(){
     },
});

console.log(jdata)

//座標的排序不一定會照大小，所以先把所有經緯度分別抓到latlist和lonlist，再把兩個陣列由小到大排序，最後取第0個和第4個就會分別是最大和最小值
for (var i=0;i < jdata.features.length; i++){
    var latlist = [];
	var lonlist = [];
	for (var j=0;j<jdata.features[i].geometry.coordinates[0].length;j++){
	    coord = jdata.features[i].geometry.coordinates[0][j]
		latlist.push(coord[0]);
		lonlist.push(coord[1]);
	};
	latlist = latlist.sort(function(a,b){return a-b});
	lonlist = lonlist.sort(function(a,b){return a-b});
	n = lonlist[4];
	w = latlist[0];
	s = lonlist[0];
	e = latlist[4];
	bound = {
	    north:n,
		west:w,
		south:s,
		east:e
	};
	bounds.push(bound);
};

///////////////////////////////////Start of initMap()//////////////////////////////////////
function initMap() {
    population_list = [];
    households_list = [];
	for (var i=0;i < jdata.features.length; i++){
	    population_list.push(jdata.features[i].properties.population);
		households_list.push(jdata.features[i].properties.households);
	};
	population_list = population_list.sort(function(b,a){return a-b});
	households_list = households_list.sort(function(b,a){return a-b});
	
    map = new google.maps.Map(document.getElementById('map'), {
          zoom: 12,
          center: {lat: 24.786005, lng:120.950411},
		  styles:map_style_json
        });

    function createRectangle(boundary,pop,house) {
		var rectangle = new google.maps.Rectangle({
            bounds:boundary,
		    strokeColor: "#000",
            strokeOpacity: 1.0,
            strokeWeight: 0.5,
		    fillColor:"#000",
		    map:map
	    });
		rec_object_list.push(rectangle);
	    rectangle.population = pop;
	    rectangle.households = house;
		
		google.maps.event.addListener(rectangle,"mouseover",function(){
	    rectangle.setOptions({
	    strokeColor : "#FF0000",
	    strokeWeight: 2,
		fillOpacity:0.3
	    });
	    });
	    google.maps.event.addListener(rectangle,"mouseout",function(){
	        rectangle.setOptions({
	            strokeColor : "#000",
	            strokeWeight: 0.5,
	    		fillOpacity:0.3
	        });
	    });
        google.maps.event.addListener(rectangle, "click", function() { 
            rec_object_list.forEach((val) => {
	    	    val.setOptions({
	    		    fillColor:"#000",
	    			fillOpacity:0.3
	    		});
	    	});
	    	rectangle.setOptions({
	            fillColor:"RGB(246,197,85)",
	    		fillOpacity:0.3
	        });
	    	
	    	createMessage(rectangle);
        });
    return rectangle;  
    }

createRecs();
				
function createMessage(rectangle){
    var pr_json = [['pop_bar',0],['house_bar',0]];
    var html_str = "";
    html_str = create_html_str('pop_bar','人口',rectangle.population,population_list,html_str);
	html_str = create_html_str('house_bar','住宅數',rectangle.households,households_list,html_str);
	$("#test").text("");
    $("#test").append(html_str);
	
	for (var i=0;i<pr_json.length;i++ ){
			myMove(pr_json[i][0],pr_json[i][1]);
	    };

    function myMove(elem_id,max_width) {
      var elem = document.getElementById(elem_id);	
      var bar_width = 0;
      var id = setInterval(frame, 5);
      function frame() {
	    if (max_width == 0){
		    elem.style.width = '1%';
		}
		else{
            if (bar_width == max_width) {
              clearInterval(id);
            } else {
              bar_width++; 
              elem.style.width = bar_width + '%'; 
            }
		}
      }
    }
    
    var sum_str = "";
	sum_str = create_sum_str('人口',rectangle.population,population_list,sum_str,"人");
	sum_str = create_sum_str('住宅數',rectangle.households,households_list,sum_str,"戶");
	$("#test").append(sum_str);
	
	function create_html_str(bar_id,attr_name,attribute,attribute_list,html_str){
	    rank = attribute_list.indexOf(attribute) + 1;
        pr = Math.round(((attribute_list.length - rank) / (attribute_list.length) * 100));
		for (var i=0;i<pr_json.length;i++ ){
		    if(pr_json[i][0] == bar_id){
			    pr_json[i][1] = pr;
			};
	    };
		html_str +=  '<label>' + attr_name + '</label>' ;
        html_str +=  '<div class="attr_bar">';
        html_str += '<div class="attr_str attr_value" ' + 'id="' + bar_id + '">';
        html_str += '<p>' + attribute + '</p>';
        html_str += '</div>';
        html_str += '</div>';
		return html_str;
	};
	function create_sum_str(attr_name,attribute,attribute_list,sum_str,unit){
	    rank = attribute_list.indexOf(attribute) + 1;
        pr = Math.round(((attribute_list.length - rank) / (attribute_list.length) * 100));
		sum_str += "此區域的" + attr_name + "是" + attribute + unit +"，PR值為" + pr + "。";
		return sum_str;
	};
};

function createRecs(){
rec0 = createRectangle(bounds[0],jdata.features[0].properties.population,jdata.features[0].properties.households);
rec1 = createRectangle(bounds[1],jdata.features[1].properties.population,jdata.features[1].properties.households);
rec2 = createRectangle(bounds[2],jdata.features[2].properties.population,jdata.features[2].properties.households);
rec3 = createRectangle(bounds[3],jdata.features[3].properties.population,jdata.features[3].properties.households);
rec4 = createRectangle(bounds[4],jdata.features[4].properties.population,jdata.features[4].properties.households);
rec5 = createRectangle(bounds[5],jdata.features[5].properties.population,jdata.features[5].properties.households);
rec6 = createRectangle(bounds[6],jdata.features[6].properties.population,jdata.features[6].properties.households);
rec7 = createRectangle(bounds[7],jdata.features[7].properties.population,jdata.features[7].properties.households);
rec8 = createRectangle(bounds[8],jdata.features[8].properties.population,jdata.features[8].properties.households);
rec9 = createRectangle(bounds[9],jdata.features[9].properties.population,jdata.features[9].properties.households);
rec10 = createRectangle(bounds[10],jdata.features[10].properties.population,jdata.features[10].properties.households);
rec11 = createRectangle(bounds[11],jdata.features[11].properties.population,jdata.features[11].properties.households);
rec12 = createRectangle(bounds[12],jdata.features[12].properties.population,jdata.features[12].properties.households);
rec13 = createRectangle(bounds[13],jdata.features[13].properties.population,jdata.features[13].properties.households);
rec14 = createRectangle(bounds[14],jdata.features[14].properties.population,jdata.features[14].properties.households);
rec15 = createRectangle(bounds[15],jdata.features[15].properties.population,jdata.features[15].properties.households);
rec16 = createRectangle(bounds[16],jdata.features[16].properties.population,jdata.features[16].properties.households);
rec17 = createRectangle(bounds[17],jdata.features[17].properties.population,jdata.features[17].properties.households);
rec18 = createRectangle(bounds[18],jdata.features[18].properties.population,jdata.features[18].properties.households);
rec19 = createRectangle(bounds[19],jdata.features[19].properties.population,jdata.features[19].properties.households);
rec20 = createRectangle(bounds[20],jdata.features[20].properties.population,jdata.features[20].properties.households);
rec21 = createRectangle(bounds[21],jdata.features[21].properties.population,jdata.features[21].properties.households);
rec22 = createRectangle(bounds[22],jdata.features[22].properties.population,jdata.features[22].properties.households);
rec23 = createRectangle(bounds[23],jdata.features[23].properties.population,jdata.features[23].properties.households);
rec24 = createRectangle(bounds[24],jdata.features[24].properties.population,jdata.features[24].properties.households);
rec25 = createRectangle(bounds[25],jdata.features[25].properties.population,jdata.features[25].properties.households);
rec26 = createRectangle(bounds[26],jdata.features[26].properties.population,jdata.features[26].properties.households);
rec27 = createRectangle(bounds[27],jdata.features[27].properties.population,jdata.features[27].properties.households);
rec28 = createRectangle(bounds[28],jdata.features[28].properties.population,jdata.features[28].properties.households);
rec29 = createRectangle(bounds[29],jdata.features[29].properties.population,jdata.features[29].properties.households);
rec30 = createRectangle(bounds[30],jdata.features[30].properties.population,jdata.features[30].properties.households);
rec31 = createRectangle(bounds[31],jdata.features[31].properties.population,jdata.features[31].properties.households);
rec32 = createRectangle(bounds[32],jdata.features[32].properties.population,jdata.features[32].properties.households);
rec33 = createRectangle(bounds[33],jdata.features[33].properties.population,jdata.features[33].properties.households);
rec34 = createRectangle(bounds[34],jdata.features[34].properties.population,jdata.features[34].properties.households);
rec35 = createRectangle(bounds[35],jdata.features[35].properties.population,jdata.features[35].properties.households);
rec36 = createRectangle(bounds[36],jdata.features[36].properties.population,jdata.features[36].properties.households);
rec37 = createRectangle(bounds[37],jdata.features[37].properties.population,jdata.features[37].properties.households);
rec38 = createRectangle(bounds[38],jdata.features[38].properties.population,jdata.features[38].properties.households);
rec39 = createRectangle(bounds[39],jdata.features[39].properties.population,jdata.features[39].properties.households);
rec40 = createRectangle(bounds[40],jdata.features[40].properties.population,jdata.features[40].properties.households);
rec41 = createRectangle(bounds[41],jdata.features[41].properties.population,jdata.features[41].properties.households);
rec42 = createRectangle(bounds[42],jdata.features[42].properties.population,jdata.features[42].properties.households);
rec43 = createRectangle(bounds[43],jdata.features[43].properties.population,jdata.features[43].properties.households);
rec44 = createRectangle(bounds[44],jdata.features[44].properties.population,jdata.features[44].properties.households);
rec45 = createRectangle(bounds[45],jdata.features[45].properties.population,jdata.features[45].properties.households);
rec46 = createRectangle(bounds[46],jdata.features[46].properties.population,jdata.features[46].properties.households);
rec47 = createRectangle(bounds[47],jdata.features[47].properties.population,jdata.features[47].properties.households);
rec48 = createRectangle(bounds[48],jdata.features[48].properties.population,jdata.features[48].properties.households);
rec49 = createRectangle(bounds[49],jdata.features[49].properties.population,jdata.features[49].properties.households);
rec50 = createRectangle(bounds[50],jdata.features[50].properties.population,jdata.features[50].properties.households);
rec51 = createRectangle(bounds[51],jdata.features[51].properties.population,jdata.features[51].properties.households);
rec52 = createRectangle(bounds[52],jdata.features[52].properties.population,jdata.features[52].properties.households);
rec53 = createRectangle(bounds[53],jdata.features[53].properties.population,jdata.features[53].properties.households);
rec54 = createRectangle(bounds[54],jdata.features[54].properties.population,jdata.features[54].properties.households);
rec55 = createRectangle(bounds[55],jdata.features[55].properties.population,jdata.features[55].properties.households);
rec56 = createRectangle(bounds[56],jdata.features[56].properties.population,jdata.features[56].properties.households);
rec57 = createRectangle(bounds[57],jdata.features[57].properties.population,jdata.features[57].properties.households);
rec58 = createRectangle(bounds[58],jdata.features[58].properties.population,jdata.features[58].properties.households);
rec59 = createRectangle(bounds[59],jdata.features[59].properties.population,jdata.features[59].properties.households);
rec60 = createRectangle(bounds[60],jdata.features[60].properties.population,jdata.features[60].properties.households);
rec61 = createRectangle(bounds[61],jdata.features[61].properties.population,jdata.features[61].properties.households);
rec62 = createRectangle(bounds[62],jdata.features[62].properties.population,jdata.features[62].properties.households);
rec63 = createRectangle(bounds[63],jdata.features[63].properties.population,jdata.features[63].properties.households);
rec64 = createRectangle(bounds[64],jdata.features[64].properties.population,jdata.features[64].properties.households);
rec65 = createRectangle(bounds[65],jdata.features[65].properties.population,jdata.features[65].properties.households);
rec66 = createRectangle(bounds[66],jdata.features[66].properties.population,jdata.features[66].properties.households);
rec67 = createRectangle(bounds[67],jdata.features[67].properties.population,jdata.features[67].properties.households);
rec68 = createRectangle(bounds[68],jdata.features[68].properties.population,jdata.features[68].properties.households);
rec69 = createRectangle(bounds[69],jdata.features[69].properties.population,jdata.features[69].properties.households);
rec70 = createRectangle(bounds[70],jdata.features[70].properties.population,jdata.features[70].properties.households);
rec71 = createRectangle(bounds[71],jdata.features[71].properties.population,jdata.features[71].properties.households);
rec72 = createRectangle(bounds[72],jdata.features[72].properties.population,jdata.features[72].properties.households);
rec73 = createRectangle(bounds[73],jdata.features[73].properties.population,jdata.features[73].properties.households);
rec74 = createRectangle(bounds[74],jdata.features[74].properties.population,jdata.features[74].properties.households);
rec75 = createRectangle(bounds[75],jdata.features[75].properties.population,jdata.features[75].properties.households);
rec76 = createRectangle(bounds[76],jdata.features[76].properties.population,jdata.features[76].properties.households);
rec77 = createRectangle(bounds[77],jdata.features[77].properties.population,jdata.features[77].properties.households);
rec78 = createRectangle(bounds[78],jdata.features[78].properties.population,jdata.features[78].properties.households);
rec79 = createRectangle(bounds[79],jdata.features[79].properties.population,jdata.features[79].properties.households);
rec80 = createRectangle(bounds[80],jdata.features[80].properties.population,jdata.features[80].properties.households);
rec81 = createRectangle(bounds[81],jdata.features[81].properties.population,jdata.features[81].properties.households);
rec82 = createRectangle(bounds[82],jdata.features[82].properties.population,jdata.features[82].properties.households);
rec83 = createRectangle(bounds[83],jdata.features[83].properties.population,jdata.features[83].properties.households);
rec84 = createRectangle(bounds[84],jdata.features[84].properties.population,jdata.features[84].properties.households);
rec85 = createRectangle(bounds[85],jdata.features[85].properties.population,jdata.features[85].properties.households);
rec86 = createRectangle(bounds[86],jdata.features[86].properties.population,jdata.features[86].properties.households);
rec87 = createRectangle(bounds[87],jdata.features[87].properties.population,jdata.features[87].properties.households);
rec88 = createRectangle(bounds[88],jdata.features[88].properties.population,jdata.features[88].properties.households);
rec89 = createRectangle(bounds[89],jdata.features[89].properties.population,jdata.features[89].properties.households);
rec90 = createRectangle(bounds[90],jdata.features[90].properties.population,jdata.features[90].properties.households);
rec91 = createRectangle(bounds[91],jdata.features[91].properties.population,jdata.features[91].properties.households);
rec92 = createRectangle(bounds[92],jdata.features[92].properties.population,jdata.features[92].properties.households);
rec93 = createRectangle(bounds[93],jdata.features[93].properties.population,jdata.features[93].properties.households);
rec94 = createRectangle(bounds[94],jdata.features[94].properties.population,jdata.features[94].properties.households);
rec95 = createRectangle(bounds[95],jdata.features[95].properties.population,jdata.features[95].properties.households);
rec96 = createRectangle(bounds[96],jdata.features[96].properties.population,jdata.features[96].properties.households);
rec97 = createRectangle(bounds[97],jdata.features[97].properties.population,jdata.features[97].properties.households);
rec98 = createRectangle(bounds[98],jdata.features[98].properties.population,jdata.features[98].properties.households);
rec99 = createRectangle(bounds[99],jdata.features[99].properties.population,jdata.features[99].properties.households);
rec100 = createRectangle(bounds[100],jdata.features[100].properties.population,jdata.features[100].properties.households);
rec101 = createRectangle(bounds[101],jdata.features[101].properties.population,jdata.features[101].properties.households);
rec102 = createRectangle(bounds[102],jdata.features[102].properties.population,jdata.features[102].properties.households);
rec103 = createRectangle(bounds[103],jdata.features[103].properties.population,jdata.features[103].properties.households);
rec104 = createRectangle(bounds[104],jdata.features[104].properties.population,jdata.features[104].properties.households);
rec105 = createRectangle(bounds[105],jdata.features[105].properties.population,jdata.features[105].properties.households);
rec106 = createRectangle(bounds[106],jdata.features[106].properties.population,jdata.features[106].properties.households);
rec107 = createRectangle(bounds[107],jdata.features[107].properties.population,jdata.features[107].properties.households);
rec108 = createRectangle(bounds[108],jdata.features[108].properties.population,jdata.features[108].properties.households);
rec109 = createRectangle(bounds[109],jdata.features[109].properties.population,jdata.features[109].properties.households);
rec110 = createRectangle(bounds[110],jdata.features[110].properties.population,jdata.features[110].properties.households);
rec111 = createRectangle(bounds[111],jdata.features[111].properties.population,jdata.features[111].properties.households);
rec112 = createRectangle(bounds[112],jdata.features[112].properties.population,jdata.features[112].properties.households);
rec113 = createRectangle(bounds[113],jdata.features[113].properties.population,jdata.features[113].properties.households);
rec114 = createRectangle(bounds[114],jdata.features[114].properties.population,jdata.features[114].properties.households);
rec115 = createRectangle(bounds[115],jdata.features[115].properties.population,jdata.features[115].properties.households);
rec116 = createRectangle(bounds[116],jdata.features[116].properties.population,jdata.features[116].properties.households);
rec117 = createRectangle(bounds[117],jdata.features[117].properties.population,jdata.features[117].properties.households);
rec118 = createRectangle(bounds[118],jdata.features[118].properties.population,jdata.features[118].properties.households);
rec119 = createRectangle(bounds[119],jdata.features[119].properties.population,jdata.features[119].properties.households);
rec120 = createRectangle(bounds[120],jdata.features[120].properties.population,jdata.features[120].properties.households);
rec121 = createRectangle(bounds[121],jdata.features[121].properties.population,jdata.features[121].properties.households);
rec122 = createRectangle(bounds[122],jdata.features[122].properties.population,jdata.features[122].properties.households);
rec123 = createRectangle(bounds[123],jdata.features[123].properties.population,jdata.features[123].properties.households);
rec124 = createRectangle(bounds[124],jdata.features[124].properties.population,jdata.features[124].properties.households);
rec125 = createRectangle(bounds[125],jdata.features[125].properties.population,jdata.features[125].properties.households);
rec126 = createRectangle(bounds[126],jdata.features[126].properties.population,jdata.features[126].properties.households);
rec127 = createRectangle(bounds[127],jdata.features[127].properties.population,jdata.features[127].properties.households);
rec128 = createRectangle(bounds[128],jdata.features[128].properties.population,jdata.features[128].properties.households);
rec129 = createRectangle(bounds[129],jdata.features[129].properties.population,jdata.features[129].properties.households);
rec130 = createRectangle(bounds[130],jdata.features[130].properties.population,jdata.features[130].properties.households);
rec131 = createRectangle(bounds[131],jdata.features[131].properties.population,jdata.features[131].properties.households);
rec132 = createRectangle(bounds[132],jdata.features[132].properties.population,jdata.features[132].properties.households);
rec133 = createRectangle(bounds[133],jdata.features[133].properties.population,jdata.features[133].properties.households);
rec134 = createRectangle(bounds[134],jdata.features[134].properties.population,jdata.features[134].properties.households);
rec135 = createRectangle(bounds[135],jdata.features[135].properties.population,jdata.features[135].properties.households);
rec136 = createRectangle(bounds[136],jdata.features[136].properties.population,jdata.features[136].properties.households);
rec137 = createRectangle(bounds[137],jdata.features[137].properties.population,jdata.features[137].properties.households);
rec138 = createRectangle(bounds[138],jdata.features[138].properties.population,jdata.features[138].properties.households);
rec139 = createRectangle(bounds[139],jdata.features[139].properties.population,jdata.features[139].properties.households);
rec140 = createRectangle(bounds[140],jdata.features[140].properties.population,jdata.features[140].properties.households);
rec141 = createRectangle(bounds[141],jdata.features[141].properties.population,jdata.features[141].properties.households);
rec142 = createRectangle(bounds[142],jdata.features[142].properties.population,jdata.features[142].properties.households);
rec143 = createRectangle(bounds[143],jdata.features[143].properties.population,jdata.features[143].properties.households);
rec144 = createRectangle(bounds[144],jdata.features[144].properties.population,jdata.features[144].properties.households);
rec145 = createRectangle(bounds[145],jdata.features[145].properties.population,jdata.features[145].properties.households);
rec146 = createRectangle(bounds[146],jdata.features[146].properties.population,jdata.features[146].properties.households);
rec147 = createRectangle(bounds[147],jdata.features[147].properties.population,jdata.features[147].properties.households);
rec148 = createRectangle(bounds[148],jdata.features[148].properties.population,jdata.features[148].properties.households);
rec149 = createRectangle(bounds[149],jdata.features[149].properties.population,jdata.features[149].properties.households);
rec150 = createRectangle(bounds[150],jdata.features[150].properties.population,jdata.features[150].properties.households);
rec151 = createRectangle(bounds[151],jdata.features[151].properties.population,jdata.features[151].properties.households);
rec152 = createRectangle(bounds[152],jdata.features[152].properties.population,jdata.features[152].properties.households);
rec153 = createRectangle(bounds[153],jdata.features[153].properties.population,jdata.features[153].properties.households);
rec154 = createRectangle(bounds[154],jdata.features[154].properties.population,jdata.features[154].properties.households);
rec155 = createRectangle(bounds[155],jdata.features[155].properties.population,jdata.features[155].properties.households);
rec156 = createRectangle(bounds[156],jdata.features[156].properties.population,jdata.features[156].properties.households);
rec157 = createRectangle(bounds[157],jdata.features[157].properties.population,jdata.features[157].properties.households);
rec158 = createRectangle(bounds[158],jdata.features[158].properties.population,jdata.features[158].properties.households);
rec159 = createRectangle(bounds[159],jdata.features[159].properties.population,jdata.features[159].properties.households);
rec160 = createRectangle(bounds[160],jdata.features[160].properties.population,jdata.features[160].properties.households);
rec161 = createRectangle(bounds[161],jdata.features[161].properties.population,jdata.features[161].properties.households);
rec162 = createRectangle(bounds[162],jdata.features[162].properties.population,jdata.features[162].properties.households);
rec163 = createRectangle(bounds[163],jdata.features[163].properties.population,jdata.features[163].properties.households);
rec164 = createRectangle(bounds[164],jdata.features[164].properties.population,jdata.features[164].properties.households);
rec165 = createRectangle(bounds[165],jdata.features[165].properties.population,jdata.features[165].properties.households);
rec166 = createRectangle(bounds[166],jdata.features[166].properties.population,jdata.features[166].properties.households);
rec167 = createRectangle(bounds[167],jdata.features[167].properties.population,jdata.features[167].properties.households);
rec168 = createRectangle(bounds[168],jdata.features[168].properties.population,jdata.features[168].properties.households);
rec169 = createRectangle(bounds[169],jdata.features[169].properties.population,jdata.features[169].properties.households);
rec170 = createRectangle(bounds[170],jdata.features[170].properties.population,jdata.features[170].properties.households);
rec171 = createRectangle(bounds[171],jdata.features[171].properties.population,jdata.features[171].properties.households);
rec172 = createRectangle(bounds[172],jdata.features[172].properties.population,jdata.features[172].properties.households);
rec173 = createRectangle(bounds[173],jdata.features[173].properties.population,jdata.features[173].properties.households);
rec174 = createRectangle(bounds[174],jdata.features[174].properties.population,jdata.features[174].properties.households);
rec175 = createRectangle(bounds[175],jdata.features[175].properties.population,jdata.features[175].properties.households);
rec176 = createRectangle(bounds[176],jdata.features[176].properties.population,jdata.features[176].properties.households);
rec177 = createRectangle(bounds[177],jdata.features[177].properties.population,jdata.features[177].properties.households);
rec178 = createRectangle(bounds[178],jdata.features[178].properties.population,jdata.features[178].properties.households);
rec179 = createRectangle(bounds[179],jdata.features[179].properties.population,jdata.features[179].properties.households);
rec180 = createRectangle(bounds[180],jdata.features[180].properties.population,jdata.features[180].properties.households);
rec181 = createRectangle(bounds[181],jdata.features[181].properties.population,jdata.features[181].properties.households);
rec182 = createRectangle(bounds[182],jdata.features[182].properties.population,jdata.features[182].properties.households);
rec183 = createRectangle(bounds[183],jdata.features[183].properties.population,jdata.features[183].properties.households);
rec184 = createRectangle(bounds[184],jdata.features[184].properties.population,jdata.features[184].properties.households);
rec185 = createRectangle(bounds[185],jdata.features[185].properties.population,jdata.features[185].properties.households);
rec186 = createRectangle(bounds[186],jdata.features[186].properties.population,jdata.features[186].properties.households);
rec187 = createRectangle(bounds[187],jdata.features[187].properties.population,jdata.features[187].properties.households);
rec188 = createRectangle(bounds[188],jdata.features[188].properties.population,jdata.features[188].properties.households);
rec189 = createRectangle(bounds[189],jdata.features[189].properties.population,jdata.features[189].properties.households);
rec190 = createRectangle(bounds[190],jdata.features[190].properties.population,jdata.features[190].properties.households);
rec191 = createRectangle(bounds[191],jdata.features[191].properties.population,jdata.features[191].properties.households);
rec192 = createRectangle(bounds[192],jdata.features[192].properties.population,jdata.features[192].properties.households);
rec193 = createRectangle(bounds[193],jdata.features[193].properties.population,jdata.features[193].properties.households);
rec194 = createRectangle(bounds[194],jdata.features[194].properties.population,jdata.features[194].properties.households);
};
};
///////////////////////////////////End of initMap()////////////////////////////////////// 
 
function pop_heat_map(){
    rec_object_list.forEach((rec) => {
	    google.maps.event.clearInstanceListeners(rec); //移除事件
	    rank = population_list.indexOf(rec.population) + 1;
        pr = Math.round(((population_list.length - rank) / (population_list.length) * 100));
		if (pr >= 0 && pr < 14){
		    rec.setOptions({
			    fillColor:ingradient_colors[6]
			});
		}
		else if (pr >= 14 && pr < 28){
		    rec.setOptions({
			    fillColor:ingradient_colors[5]
			});
		}
		else if (pr >= 28 && pr < 42){
		    rec.setOptions({
			    fillColor:ingradient_colors[4]
			});
		}
		else if (pr >= 42 && pr < 56){
		    rec.setOptions({
			    fillColor:ingradient_colors[3]
			});
		}
		else if (pr >= 56 && pr < 70){
		    rec.setOptions({
			    fillColor:ingradient_colors[2]
			});
		}
		else if (pr >= 70 && pr < 86){
		    rec.setOptions({
			    fillColor:ingradient_colors[1]
			});
		}
		else if (pr >= 86){
		    rec.setOptions({
			    fillColor:ingradient_colors[0],
			});
		}
		rec.setOptions({
			fillOpacity:0.8
		});
	});
};
 
 map_style_json =  [ {
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#f5f5f5"
      }
    ]
  },
  {
    "elementType": "labels.icon",
    "stylers": [
      {
        "visibility": "off"
      }
    ]
  },
  {
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#616161"
      }
    ]
  },
  {
    "elementType": "labels.text.stroke",
    "stylers": [
      {
        "color": "#f5f5f5"
      }
    ]
  },
  {
    "featureType": "administrative.land_parcel",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#bdbdbd"
      }
    ]
  },
  {
    "featureType": "poi",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#eeeeee"
      }
    ]
  },
  {
    "featureType": "poi",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#757575"
      }
    ]
  },
  {
    "featureType": "poi.park",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#e5e5e5"
      }
    ]
  },
  {
    "featureType": "poi.park",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#9e9e9e"
      }
    ]
  },
  {
    "featureType": "road",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#ffffff"
      }
    ]
  },
  {
    "featureType": "road.arterial",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#757575"
      }
    ]
  },
  {
    "featureType": "road.highway",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#dadada"
      }
    ]
  },
  {
    "featureType": "road.highway",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#616161"
      }
    ]
  },
  {
    "featureType": "road.local",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#9e9e9e"
      }
    ]
  },
  {
    "featureType": "transit.line",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#e5e5e5"
      }
    ]
  },
  {
    "featureType": "transit.station",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#eeeeee"
      }
    ]
  },
  {
    "featureType": "water",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#c9c9c9"
      }
    ]
  },
  {
    "featureType": "water",
    "elementType": "geometry.fill",
    "stylers": [
      {
        "color": "#63cfd8"
      }
    ]
  },
  {
    "featureType": "water",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#9e9e9e"
      }
    ]
  }
];
 
</script>

<script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js">
</script>
	
<script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDW2R3JvnGX3WPGyv2NOH_TbprbOIFmBuc&libraries=visualization&callback=initMap">
</script>

</body>
</html>
